{"version":3,"file":"edu.min.js","sources":["../src/edu.js"],"sourcesContent":["// This file is part of edu-sharing created by metaVentis GmbH — http://metaventis.com\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @copyright  metaVentis GmbH — http://metaventis.com\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\ndefine(['jquery'], function($) {\n\n    return {\n        init: function() {\n\n            // eslint-disable-next-line @babel/no-unused-expressions\n            !(function() {\n                /**\n                 * @param {number} a\n                 * @param {number} b\n                 */\n                function a(a, b) {\n                    var c = void 0 !== window.pageYOffset ? window.pageYOffset : (document.documentElement ||\n                            document.body.parentNode || document.body).scrollTop,\n                        d = document.documentElement.clientHeight,\n                        e = c + d;\n                    b = b || 0;\n                    var f = a.getBoundingClientRect();\n                    if (0 === f.height) {\n                     return !1;\n                    }\n                    var g = f.top + c - b,\n                        h = f.bottom + c + b;\n                    return h > c && e > g;\n                }\n\n                $.expr[\":\"][\"near-viewport\"] = function(b, c, d) {\n                    var e = parseInt(d[3]) || 0;\n                    return a(b, e);\n                };\n            }());\n\n            $.ajaxSetup({cache: false});\n\n            var videoFormat = 'webm';\n            var v = document.createElement('video');\n            if (v.canPlayType && v.canPlayType('video/mp4').replace(/no/, '')) {\n                videoFormat = 'mp4';\n            }\n\n            /**\n             * @param {object} esObject\n             * @param {jQuery} wrapper\n             */\n            function renderEsObject(esObject, wrapper) {\n                var url = esObject.attr(\"data-url\") + '&videoFormat=' + videoFormat;\n                if (typeof wrapper == 'undefined') {\n                    var wrapper = esObject.parent();\n                }\n                $.get(url, function(data) {\n                    wrapper.html('').append(data).css({display: 'none', height: 'auto', width: 'auto'}).fadeIn('slow', 'linear');\n                    if (data.toLowerCase().indexOf('data-view=\"lock\"') >= 0) {\n                        setTimeout(function() {\n                            renderEsObject(esObject, wrapper);\n                        }, 1111);\n                    }\n                });\n                esObject.removeAttr(\"data-type\");\n            }\n\n            $(\"div[data-type='esObject']:near-viewport(400)\").each(function() {\n                renderEsObject($(this));\n            });\n\n            // fix in case the theme does scroll via div/local container and not via window viewport\n            setInterval(function() {\n                $(\"div[data-type='esObject']:near-viewport(400)\").each(function() {\n                    renderEsObject($(this));\n                });}, 1000);\n\n            $(window).scroll(function() {\n                $(\"div[data-type='esObject']:near-viewport(400)\").each(function() {\n                    renderEsObject($(this));\n                });\n            });\n\n            $(\"body\").click(function(e) {\n                if ($(e.target).closest(\".edusharing_metadata\").length) {\n                    // Clicked inside \".edusharing_metadata\" - do nothing\n                } else if ($(e.target).closest(\".edusharing_metadata_toggle_button\").length) {\n                    $(\".edusharing_metadata\").fadeOut('fast');\n                    let toggle_button = $(e.target);\n                    let metadata = toggle_button.parent().find(\".edusharing_metadata\");\n                    if (metadata.hasClass('open')) {\n                        metadata.toggleClass('open');\n                        metadata.fadeOut('fast');\n                    } else {\n                        $(\".edusharing_metadata\").removeClass('open');\n                        metadata.toggleClass('open');\n                        metadata.fadeIn('fast');\n                    }\n                } else {\n                    $(\".edusharing_metadata\").fadeOut('fast');\n                    $(\".edusharing_metadata\").removeClass('open');\n                }\n            });\n        }\n    };\n});\n"],"names":["define","$","init","expr","b","c","d","a","window","pageYOffset","document","documentElement","body","parentNode","scrollTop","e","clientHeight","f","getBoundingClientRect","height","g","top","bottom","parseInt","ajaxSetup","cache","videoFormat","v","createElement","renderEsObject","esObject","wrapper","url","attr","parent","get","data","html","append","css","display","width","fadeIn","toLowerCase","indexOf","setTimeout","removeAttr","canPlayType","replace","each","this","setInterval","scroll","click","target","closest","length","fadeOut","metadata","find","hasClass","toggleClass","removeClass"],"mappings":";;;;AAqBAA,+BAAO,CAAC,WAAW,SAASC,SAEjB,CACHC,KAAM,WAuBED,EAAEE,KAAK,KAAK,iBAAmB,SAASC,EAAGC,EAAGC,mBAfnCC,EAAGH,OACNC,OAAI,IAAWG,OAAOC,YAAcD,OAAOC,aAAeC,SAASC,iBAC/DD,SAASE,KAAKC,YAAcH,SAASE,MAAME,UAE/CC,EAAIV,EADAK,SAASC,gBAAgBK,aAEjCZ,EAAIA,GAAK,MACLa,EAAIV,EAAEW,2BACN,IAAMD,EAAEE,cACJ,MAEJC,EAAIH,EAAEI,IAAMhB,EAAID,SACZa,EAAEK,OAASjB,EAAID,EACZC,GAAKU,EAAIK,EAKbb,CAAEH,EADDmB,SAASjB,EAAE,KAAO,IAKlCL,EAAEuB,UAAU,CAACC,OAAO,QAEhBC,YAAc,OACdC,EAAIjB,SAASkB,cAAc,kBAStBC,eAAeC,SAAUC,aAC1BC,IAAMF,SAASG,KAAK,YAAc,gBAAkBP,oBAClC,IAAXK,QACHA,QAAUD,SAASI,SAE3BjC,EAAEkC,IAAIH,KAAK,SAASI,MAChBL,QAAQM,KAAK,IAAIC,OAAOF,MAAMG,IAAI,CAACC,QAAS,OAAQrB,OAAQ,OAAQsB,MAAO,SAASC,OAAO,OAAQ,UAC/FN,KAAKO,cAAcC,QAAQ,qBAAuB,GAClDC,YAAW,WACPhB,eAAeC,SAAUC,WAC1B,SAGXD,SAASgB,WAAW,aArBpBnB,EAAEoB,aAAepB,EAAEoB,YAAY,aAAaC,QAAQ,KAAM,MAC1DtB,YAAc,OAuBlBzB,EAAE,gDAAgDgD,MAAK,WACnDpB,eAAe5B,EAAEiD,UAIrBC,aAAY,WACRlD,EAAE,gDAAgDgD,MAAK,WACnDpB,eAAe5B,EAAEiD,YACf,KAEVjD,EAAEO,QAAQ4C,QAAO,WACbnD,EAAE,gDAAgDgD,MAAK,WACnDpB,eAAe5B,EAAEiD,aAIzBjD,EAAE,QAAQoD,OAAM,SAAStC,MACjBd,EAAEc,EAAEuC,QAAQC,QAAQ,wBAAwBC,aAEzC,GAAIvD,EAAEc,EAAEuC,QAAQC,QAAQ,sCAAsCC,OAAQ,CACzEvD,EAAE,wBAAwBwD,QAAQ,YAE9BC,SADgBzD,EAAEc,EAAEuC,QACKpB,SAASyB,KAAK,wBACvCD,SAASE,SAAS,SAClBF,SAASG,YAAY,QACrBH,SAASD,QAAQ,UAEjBxD,EAAE,wBAAwB6D,YAAY,QACtCJ,SAASG,YAAY,QACrBH,SAAShB,OAAO,cAGpBzC,EAAE,wBAAwBwD,QAAQ,QAClCxD,EAAE,wBAAwB6D,YAAY"}